---
layout: post
title: STC 51单片机使用心得
description: 主要记录在开发stc51程遇到的问题及学习到的知识。
keywords: Ubuntu
---
###问题汇总
1.添加串口打印出现乱码(时间成本2级)
答：很有可能是定时器1配置的有问题，利用一些帮助工具可以自动生成初始化代码。
2.射频发送和串口发送产生冲突，表现方式就是在没有使用串口之前，射频是可以发送数据的，但是使用过串口发送数据之后就不能正常的送射频数据（时间成本2级）
答：因为在在射频发送的函数中使用了定时器1，然后在射频发送的过程中也使用了定时器1，结果就是导致前面,结果导致前面对定时器的配置被覆盖了。
3.射频发送，但是接收端无法接收到数据，后来偶然发现在发送过程中始终占着相应的频段，让其他的设备无法发送射频数据。（时间成本5+级）
答：首先是没有找到问题所在，一直以为是射频发送的那个IO口配置有问题，所以花费了大量的时间在这个方面。其次发现在定时器配置那边也是有点问题，但是问题依然没有解决。最后发现在同事写的一个射频发送函数中，使用了查询定时器中断的方式进行了一个占空比的设置，判断语句是<pre>while(!TF1)</pre>,然而我在其他函数中开启了定时器1的中断<pre>ET1 = 1</pre>,当TF1值为1的时候，会产生中断，同时硬件将中断清0，那么这边上面的查询始终得不到1，所以始终为真。
4.这个现象记得不太清楚了，有空补上
答：主要就是开启了定时器0的中断，但是自己没有为这个中断编写中断子函数，同时也没有在主函数中对这个中断进行一个轮询，结果导致执行结果不正确。其实这个中断完全是没有必要的，也是毫无用处的。经验就是以后一定要记住自己开启哪些中断，并且每个中断都必须要有对应的处理函数。
5.Keil使用中遇到的问题
主要就是按照规范来建立工程，就会少了很多问题。如果需要生成汇编代码，则需要右击，选择option，然后里面有生成汇编代码的选项，将灰色的变成选中的状态。同时还需要将keil安装目录下lib/C51S.lib加入到工程中，C51S是small mode使用的库，根据你的配置不同，选择不同的库。
